[TOC]



# 系统重装

系统出现故障，因此要重装系统

**备份数据：**

只要将home文件夹的数据备份到硬盘中即可

- https://steemit.com/linux/@a186r/ubuntu

**系统重装:**

- 准备一个u盘，将u盘中的内容全部删除

使用u盘下载ios ubuntu文件，建议使用windows电脑进行处理，搜索下面两个文件

- rufus，Windows下的软件，用来将iso文件拷入u盘中，将u盘变成live usb
- 下载iso文件，搜索ubuntu 20.04lts

插入u盘，然后关机重启按F12，或者F2和delete键

# 先开启ssh服务

```
sudo apt-get update
sudo apt-get install openssh-server
# 确认是否启动了ssh
ps -e | grep ssh
```

出现问题，在本地用ssh链接服务器，出现错误：

```
 WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED! 
```

在服务器上使用ip address 查看ip

在本地使用命令：

```
ssh-keygen -R 172.31.100.91
```

然后就可以链接了

参考：https://stackoverflow.com/questions/20840012/ssh-remote-host-identification-has-changed

# 用户管理

```
sudo su # 切换为root用户
```

**添加用户**

```
# 一定要切换为root用户
sudo su
# 添加用户
sudo adduser eesissi

# 删除用户
sudo userdel username

# 将用户添加为管理员权限
sudo vim /etc/sudoers
# 添加下面命令
eesissi ALL=(ALL:ALL) ALL
```

# 硬盘挂载

关机重启后，发现硬盘都没有读取到，进入机房将服务器关机后，发现变成foreign了，要进行配置将硬盘变成online。

F2 -> configration management-> import foreign disk

设置完后可以发现硬盘都变成online了

登陆服务器

```
# 使用命令查看
sudo fdisk -l
```

参考：[挂载说明](https://github.com/Miki123-gif/Notes/blob/master/Linux%26Shell%20script/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9B%BA%E6%80%81%E7%A1%AC%E7%9B%98%E6%8C%82%E8%BD%BD.md)

# 配置开机自动启动项

```
# 这个文件管理当前用户登陆，就会执行里面的命令
vi ~/.bash_profile
```

- 首先硬盘肯定要开机自动mount

```
vi ~/.bash_profile
```

# 软件安装

1. **nvim安装**

```
sudo apt install neovim
```

**配置：**

```
mkdir ~/.config/nvim/
# init vim 文件相当于.vimrc文件
nvim ~/.config/nvim/init.vim
```

2. **Tmux安装**

```
sudo apt install tmux
```

**配置：**

```
vim ~/.tmux.conf

bind-key k select-pane -U
bind-key j select-pane -D
bind-key h select-pane -L
bind-key l select-pane -R
```

3. **Git 安装**

```
sudo apt install git
```

4. **Vncserver** 

vncserver为可视化界面，输入下面命令进行安装

**说明：**

- 配置好后，以后程序开机就会自动启动，不用每次都star一下
- 先运行`systemctl status x11vnc.service # 查看是否正在运行`

参考：[配置说明](https://github.com/Miki123-gif/Notes/blob/master/Shell%20tools/VNCserver.md)

```
sudo apt-get update
sudo apt-get install lightdm
sudo reboot
sudo apt-get install x11vnc
sudo vim /lib/systemd/system/x11vnc.service
```

写入：

```
[Unit]
Description=x11vnc service
After=display-manager.service network.target syslog.target

[Service]
Type=simple
ExecStart=/usr/bin/x11vnc -forever -display :0 -auth guess -passwd password
ExecStop=/usr/bin/killall x11vnc
Restart=on-failure

[Install]
WantedBy=multi-user.target
```

执行：

```
systemctl daemon-reload
systemctl enable x11vnc.service # 让密码生效
systemctl start x11vnc.service
systemctl status x11vnc.service # 查看是否正在运行
```

